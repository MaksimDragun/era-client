<div *ngIf="registration" class="panel panel-default">
	<div class="panel-heading">{{'registrations.crud.registration-info' | translate}}</div>
	<div class="panel-body">
		<div class="form-group" [appFieldHasError]="'educationInstitution'">
			<label>{{'registrations.crud.educational-institution' | translate}}</label>
			<select required *ngIf="registrationPeriods" [disabled]="registrationPeriods.length === 1"
				[(ngModel)]="selectedPeriod" name="educationInstitution"
				#educationInstitution="ngModel" class="form-control"
				(change)="onPeriodChanged()">
				<option *ngFor="let period of registrationPeriods" [ngValue]="period">
					{{period.educationInstitution.name}}
				</option>
			</select>
		</div>
		<div class="form-group" [appFieldHasError]="'specialty'">
			<label>{{'registrations.crud.specialty' | translate}}</label>
			<select (change)="onSpecialtyChanged()" required *ngIf=specialtyList [(ngModel)]="selectedSpecialty" name="specialty"
				#speciality="ngModel" class="form-control">
				<option *ngFor="let spec of specialtyList" [ngValue]="spec">{{spec.specialty}}</option>
			</select>
		</div>
		<div *ngIf="selectedSpecialty">
			<div class="form-group" [appFieldHasError]="'fundsSource'">
				<label>{{'registrations.funds-source.title' | translate}}</label>
				<div class="row">
					<div class="col-lg-6 col-md-6 col-xs-6">
						<label *ngFor="let source of selectedSpecialty.fundsSources" class="radio-inline">
							<input type="radio" value={{source}} name="fundsSource" [(ngModel)]="registration.fundsSource">
							{{'registrations.funds-source.' + source | translate}}
						</label>
					</div>
					<div *ngIf="registration.fundsSource === 'P'" class="col-lg-6 col-md-6 col-xs-6">
						<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editPayerModal" data-backdrop="static">
						   {{'registrations.crud.add-payer' | translate}}
						</button>						
					</div>
				</div>
			</div>
			<div class="form-group" [appFieldHasError]="'educationForm'">
				<label>{{'registrations.education-form.title' | translate}}</label>
				<div>
					<label *ngFor="let form of selectedSpecialty.educationForms" class="radio-inline">
						<input type="radio" value={{form}} name="educationForm" [(ngModel)]="registration.educationForm">
						{{'registrations.education-form.' + form | translate}}
					</label>
				</div>
			</div>
			<div class="form-group" [appFieldHasError]="'educationBase'">
				<label>{{'registrations.education-base.title' | translate}}</label>
				<div class="row">
					<div class="col-lg-6 col-md-6 col-xs-6">
						<label *ngFor="let base of selectedSpecialty.educationBases" class="radio-inline">
							<input type="radio" value={{base}} name="educationBase" [(ngModel)]="registration.educationBase">
							{{'registrations.education-base.' + base | translate}}
						</label>
					</div>
					<div class="col-lg-3 col-md-3 col-xs-3">
						<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#editCertificateModal" data-backdrop="static">
							{{'registrations.crud.certificate' | translate: {"averageMark" : certificateAverageMark | number:'.1'} }}
						</button>						
					</div>
					<div *ngIf="registration.educationBase === '11'" class="col-lg-3 col-md-3 col-xs-3">
						<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#editExamSubjectsModal" data-backdrop="static">
							{{'registrations.crud.exams' | translate}}
						</button>						
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-6 col-md-6 col-xs-6">
				<div class="form-group" [appFieldHasError]="'prerogatives'">
					<label>{{'registrations.crud.prerogatives' | translate}}</label>
					<div>
						<ss-multiselect-dropdown name="prerogatives" [options]="prerogativeList" 
							[texts]="msTexts" [settings]="msSettings" [(ngModel)]="selectedPrerogatives"></ss-multiselect-dropdown>
					</div>
				</div>
			</div>
			<div class="col-lg-6 col-md-6 col-xs-6">
				<div class="form-group" [appFieldHasError]="'outOfCompetitions'">
					<label>{{'registrations.crud.out-of-competitions' | translate}}</label>
					<div>
						<ss-multiselect-dropdown name="outOfCompetitions" [options]="outOfCompetitionList" 
							[texts]="msTexts" [settings]="msSettings" [(ngModel)]="selectedOutOfCompetitions"></ss-multiselect-dropdown>
					</div>
				</div> 
			</div>
		</div>
	</div>
</div>

<app-edit-payer-modal
	*ngIf="registration"
    #editPayerModal
    [sourcePayer]="registration.payer"
    [sourceEnrolleeAsPayer]="registration.enrolleeAsPayer"
    [documentTypeList]="documentTypeList"
    [countryList]="countryList"
    (onSave)="updatePayer($event)">
</app-edit-payer-modal>

<app-edit-certificate-modal
	*ngIf="registration"
	#editCertificateModal 
	[sourceCertificate]="registration.certificate"
	[countryList]="countryList"
	(onSave)="updateCertificate($event)"
	(averageMarkChanged)="updateAverageMark($event)">
</app-edit-certificate-modal>

<app-edit-exam-subjects-modal
	*ngIf="registration"
	#editExamSubjectsModal
	[examSubjects]="selectedSpecialty ? selectedSpecialty.examSubjects : null"
	[sourceExamSubjectMarks]="registration.examSubjectMarks"
	(onSave)="updateExamSubjects($event)">
</app-edit-exam-subjects-modal>